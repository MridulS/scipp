// SPDX-License-Identifier: BSD-3-Clause
// Copyright (c) 2021 Scipp contributors (https://github.com/scipp)
/// @file
/// @author Simon Heybrock
#include "scipp/dataset/@OPNAME@.h"
#include "scipp/variable/@OPNAME@.h"

#include "dataset_operations_common.h"

namespace scipp::dataset {

DataArray &@NAME@(DataArray &lhs, const Variable &rhs) {
  @NAME@(lhs.data(), rhs);
  return lhs;
}
DataArray &@NAME@(DataArray &lhs, const DataArray &rhs) {
  try {
    expect::coords_are_superset(lhs, rhs);
    union_or_in_place(lhs.masks(), rhs.masks());
    @NAME@(lhs.data(), rhs.data());
    return lhs;
  } catch(except::CoordMismatchError &err) {
    throw except::CoordMismatchError(std::string{"In operation '@OPNAME@': "}
                                     + err.what());
  }
}
DataArray @NAME@(DataArray &&lhs, const Variable &rhs) {
  @NAME@(lhs.data(), rhs);
  return std::move(lhs);
}
DataArray @NAME@(DataArray &&lhs, const DataArray &rhs) {
  try {
    expect::coords_are_superset(lhs, rhs);
    union_or_in_place(lhs.masks(), rhs.masks());
    return @NAME@(std::move(lhs), rhs.data());
  } catch(except::CoordMismatchError &err) {
    throw except::CoordMismatchError(std::string{"In operation '@OPNAME@': "}
                                     + err.what());
  }
}

} // namespace scipp::dataset
